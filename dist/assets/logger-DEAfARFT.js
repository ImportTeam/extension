var g=Object.defineProperty;var a=(o,e,s)=>e in o?g(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var i=(o,e,s)=>a(o,typeof e!="symbol"?e+"":e,s);class r{constructor(e){i(this,"logs",[]);i(this,"batchSize",50);i(this,"flushInterval",3e4);i(this,"component");this.component=e,setInterval(()=>this.flush(),this.flushInterval)}debug(e,s){this.log("debug",e,s)}info(e,s){this.log("info",e,s)}warn(e,s){this.log("warn",e,s)}error(e,s,t){const n={...t,error:s};s&&(n.stack=s.stack),this.log("error",e,n),this.flush()}log(e,s,t){const n={level:e,message:s,component:this.component,data:this.maskSensitive(t),timestamp:Date.now(),url:typeof window<"u"?window.location.href:void 0,userAgent:typeof navigator<"u"?navigator.userAgent:void 0};this.logs.push(n),this.logs.length>=this.batchSize&&this.flush()}maskSensitive(e){return e&&(typeof e=="string"?this.maskString(e):Array.isArray(e)?e.map(s=>this.maskSensitive(s)):typeof e=="object"&&e.constructor===Object?this.maskObject(e):e)}maskString(e){const s=[/\b\d{4}[- ]?\d{4}[- ]?\d{4}[- ]?\d{4}\b/g,/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,/\b\d{3}[-.]?\d{3}[-.]?\d{4}\b/g];let t=e;return s.forEach(n=>{t=t.replace(n,"***MASKED***")}),t}maskObject(e){const s=["password","token","key","secret","email","phone","creditCard","cardNumber","cvv","pin","ssn","apiKey"],t={...e};for(const n in t)s.some(c=>n.toLowerCase().includes(c))?t[n]="***MASKED***":t[n]=this.maskSensitive(t[n]);return t}async flush(){this.logs.length!==0&&([...this.logs],this.logs=[])}}const l=new r("background"),u=new r("content"),f=new r("popup"),p=new r("offscreen"),m=new r("options");export{p as a,l as b,u as c,m as o,f as p};
