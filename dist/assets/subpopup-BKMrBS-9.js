import{r as f,j as e,R as C,a as I}from"./client-5jyeqxZ7.js";import{c as S,a as k,p as P}from"./middleware-C2IU-WCn.js";const z=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],M=S("credit-card",z);const W=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],A=S("tag",W),B={getItem:async s=>new Promise(t=>{chrome.storage.local.get([s],r=>{t(r[s]??null)})}),setItem:async(s,t)=>new Promise(r=>{chrome.storage.local.set({[s]:t},()=>{r()})}),removeItem:async s=>new Promise(t=>{chrome.storage.local.remove([s],()=>{t()})})},v=k()(P(s=>({isOpen:!1,activeTab:"list",isLoading:!1,error:null,customMethods:[],setIsOpen:t=>{s({isOpen:t})},setActiveTab:t=>{s({activeTab:t})},addPaymentMethod:t=>{const r=Date.now(),d={...t,createdAt:r,updatedAt:r,isCustom:!0};s(i=>({customMethods:[...i.customMethods,d]}))},updatePaymentMethod:(t,r)=>{s(d=>({customMethods:d.customMethods.map(i=>i.id===t?{...i,...r,updatedAt:Date.now()}:i)}))},deletePaymentMethod:t=>{s(r=>({customMethods:r.customMethods.filter(d=>d.id!==t)}))},setCustomMethods:t=>{s({customMethods:t})},reset:()=>{s({isOpen:!1,activeTab:"list",isLoading:!1,error:null,customMethods:[]})}}),{name:"subpopup-store",storage:B,partialize:s=>({customMethods:s.customMethods})})),T=()=>v(s=>s.activeTab),L=()=>v(s=>s.customMethods),b=()=>v(s=>({setIsOpen:s.setIsOpen,setActiveTab:s.setActiveTab,addPaymentMethod:s.addPaymentMethod,updatePaymentMethod:s.updatePaymentMethod,deletePaymentMethod:s.deletePaymentMethod,setCustomMethods:s.setCustomMethods,reset:s.reset})),R=()=>{const{addPaymentMethod:s}=b(),[t,r]=f.useState(!1),[d,i]=f.useState(null),[o,m]=f.useState(!1),[a,g]=f.useState({id:"",name:"",savingAmount:0,fee:.8,baseFee:.8,confidence:.8,hasInstallment:!1,installmentInfo:""}),p=h=>{const{name:l,value:x,type:y}=h.target;g(N=>({...N,[l]:y==="checkbox"?h.target.checked:y==="number"?parseFloat(x)||0:x}))},c=()=>a.id.trim()?a.name.trim()?a.savingAmount<0?(i("ì ˆì•½ ê¸ˆì•¡ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤."),!1):a.fee<0||a.fee>100?(i("ìˆ˜ìˆ˜ë£ŒëŠ” 0 ~ 100 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."),!1):a.confidence<0||a.confidence>1?(i("ì‹ ë¢°ë„ëŠ” 0 ~ 1 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."),!1):!0:(i("ê²°ì œ ìˆ˜ë‹¨ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."),!1):(i("ê²°ì œ ìˆ˜ë‹¨ IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."),!1),u=async h=>{if(h.preventDefault(),i(null),m(!1),!!c()){r(!0);try{await new Promise(x=>setTimeout(x,500));const l={id:`custom-${Date.now()}`,name:a.name,savingAmount:a.savingAmount,fee:a.fee,baseFee:a.baseFee,confidence:a.confidence,hasInstallment:a.hasInstallment,installmentInfo:a.installmentInfo||void 0};s(l),m(!0),g({id:"",name:"",savingAmount:0,fee:.8,baseFee:.8,confidence:.8,hasInstallment:!1,installmentInfo:""}),setTimeout(()=>m(!1),3e3)}catch(l){i(l instanceof Error?l.message:"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{r(!1)}}};return e.jsxs("form",{className:"form-section",onSubmit:u,children:[d&&e.jsxs("div",{className:"error-message",children:[e.jsx("strong",{children:"âš ï¸ ì˜¤ë¥˜"}),e.jsx("div",{style:{marginTop:"4px"},children:d})]}),o&&e.jsxs("div",{className:"success-message",children:[e.jsx("strong",{children:"âœ“ ì™„ë£Œ!"}),e.jsx("div",{style:{marginTop:"4px"},children:"ê²°ì œ ìˆ˜ë‹¨ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤"})]}),e.jsx("div",{style:{fontSize:"12px",fontWeight:"700",color:"var(--color-primary)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"var(--spacing-lg)",paddingBottom:"var(--spacing-md)",borderBottom:"2px solid var(--color-primary-lighter)"},children:"ê²°ì œ ìˆ˜ë‹¨ ì •ë³´"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ê²°ì œ ìˆ˜ë‹¨ ì´ë¦„"}),e.jsx("input",{type:"text",name:"name",className:"form-input",placeholder:"ì˜ˆ: ì‹ í•œì¹´ë“œ, í† ìŠ¤ë¨¸ë‹ˆ",value:a.name,onChange:p,disabled:t}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ ì‚¬ìš©ìì—ê²Œ í‘œì‹œë  ê²°ì œ ìˆ˜ë‹¨ ì´ë¦„"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ì˜ˆìƒ ì ˆì•½ ê¸ˆì•¡"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e.jsx("input",{type:"number",name:"savingAmount",className:"form-input",placeholder:"0",value:a.savingAmount,onChange:p,disabled:t,min:"0",style:{flex:1}}),e.jsx("span",{style:{color:"var(--color-text-tertiary)",fontWeight:"600"},children:"ì›"})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ ì´ ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ ì‹œ ì ˆì•½ ê°€ëŠ¥í•œ ê¸ˆì•¡"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ìˆ˜ìˆ˜ë£Œìœ¨"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e.jsx("input",{type:"number",name:"fee",className:"form-input",placeholder:"0.5",value:a.fee,onChange:p,disabled:t,min:"0",max:"100",step:"0.1",style:{flex:1}}),e.jsx("span",{style:{color:"var(--color-text-tertiary)",fontWeight:"600"},children:"%"})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ í˜„ì¬ ìˆ˜ìˆ˜ë£Œ"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ê¸°ì¤€ ìˆ˜ìˆ˜ë£Œ"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e.jsx("input",{type:"number",name:"baseFee",className:"form-input",placeholder:"0.8",value:a.baseFee,onChange:p,disabled:t,min:"0",max:"100",step:"0.1",style:{flex:1}}),e.jsx("span",{style:{color:"var(--color-text-tertiary)",fontWeight:"600"},children:"%"})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ ê¸°ì¤€ ìˆ˜ìˆ˜ë£Œ"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ì‹ ë¢°ë„"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-md)",padding:"var(--spacing-md)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)"},children:[e.jsx("input",{type:"range",name:"confidence",min:"0",max:"1",step:"0.1",value:a.confidence,onChange:p,disabled:t,style:{flex:1,cursor:t?"not-allowed":"pointer",accentColor:"var(--color-primary)"}}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"700",color:"var(--color-primary)",minWidth:"40px",textAlign:"right"},children:[(a.confidence*100).toFixed(0),"%"]})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ 0%ëŠ” ìµœí•˜, 100%ëŠ” ìµœê³  ì‹ ë¢°ë„"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"var(--spacing-md)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)",cursor:t?"not-allowed":"pointer",transition:"all 0.2s ease"},children:[e.jsx("input",{type:"checkbox",name:"hasInstallment",id:"has-installment",checked:a.hasInstallment,onChange:p,disabled:t,style:{accentColor:"var(--color-primary)",cursor:"pointer",marginRight:"var(--spacing-md)",width:"18px",height:"18px"}}),e.jsx("label",{htmlFor:"has-installment",style:{cursor:"pointer",fontSize:"13px",fontWeight:"600",color:"var(--color-text-primary)"},children:"í• ë¶€ ì§€ì›"})]}),a.hasInstallment&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"í• ë¶€ ì •ë³´"}),e.jsx("input",{type:"text",name:"installmentInfo",className:"form-input",placeholder:"ì˜ˆ: 3ê°œì›” ë¬´ì´ì, 6ê°œì›” ì´ìƒ ê°€ëŠ¥",value:a.installmentInfo,onChange:p,disabled:t}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ í• ë¶€ ì˜µì…˜ ìƒì„¸ ì •ë³´"})]}),e.jsx("div",{className:"button-group",style:{marginTop:"var(--spacing-xl)"},children:e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,style:{cursor:t?"not-allowed":"pointer",opacity:t?.7:1},children:t?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner",style:{width:"14px",height:"14px",borderWidth:"2px"}}),"ì €ì¥ ì¤‘..."]}):e.jsx(e.Fragment,{children:"âœ“ ì¶”ê°€í•˜ê¸°"})})})]})},D=()=>{const s=L(),{deletePaymentMethod:t}=b();if(s.length===0)return e.jsxs("div",{className:"payment-list-empty",children:[e.jsx("div",{className:"payment-list-empty-icon",children:"ï¿½ï¸"}),e.jsx("div",{className:"payment-list-empty-text",children:"ì•„ì§ ê²°ì œ ìˆ˜ë‹¨ì´ ì—†ì–´ìš”"}),e.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-tertiary)",marginTop:"8px"},children:"ìƒˆë¡œìš´ ê²°ì œ ìˆ˜ë‹¨ì„ ì¶”ê°€í•´ë³´ì„¸ìš”"})]});const r=i=>{window.confirm("ì •ë§ ì´ ê²°ì œ ìˆ˜ë‹¨ì„ ì‚­ì œí•˜ì‹œê² ì–´ìš”?")&&t(i)},d=i=>{const o=i.toLowerCase();return o.includes("ì¹´ë“œ")?"ğŸ’³":o.includes("ê³„ì¢Œ")||o.includes("ì†¡ê¸ˆ")?"ğŸ¦":o.includes("í¬ì¸íŠ¸")||o.includes("ì¿ í°")?"ğŸ«":o.includes("í˜ì´")||o.includes("pay")?"ğŸ“±":o.includes("í˜„ê¸ˆ")?"ğŸ’µ":"ğŸ’°"};return e.jsx("div",{className:"payment-list",children:s.map(i=>{const o=i.confidence>=.95,m=d(i.name);return e.jsxs("div",{className:"payment-item",children:[e.jsx("div",{className:"payment-item-icon",children:m}),e.jsxs("div",{className:"payment-item-content",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"var(--spacing-md)"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"payment-item-name",children:i.name}),e.jsx("div",{className:"payment-item-meta",children:e.jsx("span",{children:new Date(i.createdAt).toLocaleDateString("ko-KR")})})]}),o&&e.jsx("div",{className:"payment-item-badge success",children:"â­ ìš°ìˆ˜"})]}),e.jsxs("div",{className:"payment-item-info",children:[e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ì ˆì•½ì•¡"}),e.jsxs("span",{className:"payment-item-info-value",children:["â‚©",i.savingAmount.toLocaleString()]})]}),e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ìˆ˜ìˆ˜ë£Œ"}),e.jsxs("span",{className:"payment-item-info-value",children:[i.fee,"%"]})]}),e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ì‹ ë¢°ë„"}),e.jsxs("span",{className:"payment-item-info-value",children:[(i.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ê¸°ë³¸ìˆ˜ìˆ˜ë£Œ"}),e.jsxs("span",{className:"payment-item-info-value",children:[i.baseFee,"%"]})]})]}),i.hasInstallment&&i.installmentInfo&&e.jsxs("div",{style:{fontSize:"12px",padding:"var(--spacing-md)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)",color:"var(--color-text-secondary)",marginBottom:"var(--spacing-md)",borderLeft:"3px solid var(--color-primary-lighter)",fontWeight:"500"},children:[e.jsx("strong",{children:"í• ë¶€ ì •ë³´:"})," ",i.installmentInfo]}),e.jsxs("div",{className:"payment-item-actions",style:{justifyContent:"space-between"},children:[e.jsx("button",{className:"payment-item-btn payment-item-btn-edit",onClick:()=>alert("ìˆ˜ì • ê¸°ëŠ¥ì€ ê³§ ì¶”ê°€ë©ë‹ˆë‹¤."),style:{flex:1},title:"ìˆ˜ì •",children:"âœï¸ ìˆ˜ì •"}),e.jsx("button",{className:"payment-item-btn payment-item-btn-delete",onClick:()=>r(i.id),style:{flex:1},title:"ì‚­ì œ",children:"ğŸ—‘ï¸ ì‚­ì œ"})]})]})]},i.id)})})},E=()=>{const s=T(),{setActiveTab:t}=b();return e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"subpopup-header",children:[e.jsxs("div",{className:"subpopup-header-title",children:[e.jsx("span",{style:{fontSize:"20px",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},children:"ğŸ’³"}),e.jsx("h1",{children:"ê²°ì œ ìˆ˜ë‹¨ ê´€ë¦¬"})]}),e.jsx("button",{className:"subpopup-header-close-btn",onClick:()=>window.close(),title:"ë‹«ê¸°","aria-label":"ì°½ ë‹«ê¸°",children:"âœ•"})]}),e.jsxs("div",{className:"subpopup-tabs",children:[e.jsx("button",{className:`subpopup-tab-btn ${s==="add"?"active":""}`,onClick:()=>t("add"),"aria-selected":s==="add",children:"â• ìƒˆë¡œ ì¶”ê°€"}),e.jsx("button",{className:`subpopup-tab-btn ${s==="list"?"active":""}`,onClick:()=>t("list"),"aria-selected":s==="list",children:"ğŸ“‹ ê´€ë¦¬"})]}),e.jsxs("div",{className:"subpopup-content",style:{animation:"fadeIn 0.2s ease"},children:[s==="add"&&e.jsx(R,{}),s==="list"&&e.jsx(D,{})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(4px); }
          to { opacity: 1; transform: translateY(0); }
        }
      `})]})},F=()=>{const[s,t]=f.useState(null),[r,d]=f.useState([]),[i,o]=f.useState([]),[m,a]=f.useState(!0);return f.useEffect(()=>{(async()=>{try{const p=await chrome.storage.local.get(["currentProduct"]);if(p.currentProduct){const c=p.currentProduct;if(console.log("[useProductData] Loaded product:",{title:c.title?.substring(0,50),imageUrl:c.imageUrl?.substring(0,80)||"none",imagesCount:c.images?.length||0,variantsCount:c.variants?.length||0}),t(c),Array.isArray(c.cardBenefits)){const h=[...c.cardBenefits].sort((l,x)=>(x.rate||0)-(l.rate||0)).slice(0,3);d(h)}const u=[];c.imageUrl&&u.push(c.imageUrl),Array.isArray(c.images)&&c.images.length>0&&u.push(...c.images.filter(h=>typeof h=="string")),o(u),console.log("[useProductData] Images loaded:",u.length)}}catch(p){console.error("[useProductData] Error:",p)}finally{a(!1)}})()},[]),{product:s,topBenefits:r,imageSlides:i,loading:m}},O=({enabled:s,contentRef:t})=>{f.useEffect(()=>{if(!s||!t.current)return;const r=()=>{if(!t.current)return;const a=t.current.scrollHeight;console.log("[useWindowResize] Content scroll height:",a);const g=document.querySelector('[style*="flexShrink"]'),p=g?g.clientHeight:52,c=Math.min(p+a+24,900);console.log("[useWindowResize] Calculated total height:",{headerHeight:p,contentHeight:a,totalHeight:c});try{window.resizeTo(420,c),console.log("[useWindowResize] Window resized to:",{width:420,height:c})}catch(u){console.warn("[useWindowResize] Cannot resize window:",u)}};r();const d=new ResizeObserver(()=>{r()});d.observe(t.current);const i=t.current.querySelectorAll("img");let o=0;const m=()=>{o++,o===i.length&&setTimeout(r,100)};return i.forEach(a=>{a.complete?o++:(a.addEventListener("load",m),a.addEventListener("error",m))}),o===i.length&&setTimeout(r,100),()=>{d.disconnect(),i.forEach(a=>{a.removeEventListener("load",m),a.removeEventListener("error",m)})}},[s,t])},n={wrapper:{width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#f9fafb",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',color:"#1f2937",overflow:"hidden"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 16px",backgroundColor:"#393E44",color:"#ffffff",flexShrink:0},logoWrapper:{display:"flex",alignItems:"center",gap:"8px"},logo:{width:"18px",height:"18px",objectFit:"contain"},title:{fontSize:"15px",fontWeight:"600",color:"#ffffff"},closeBtn:{background:"none",border:"none",cursor:"pointer",padding:"4px",fontSize:"18px",color:"rgba(255, 255, 255, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",transition:"color 0.2s"},content:{flex:1,overflowY:"auto",padding:"12px 16px",display:"flex",flexDirection:"column",gap:"12px",width:"100%"},productSection:{display:"flex",gap:"12px",alignItems:"flex-start",backgroundColor:"#ffffff",borderRadius:"10px",padding:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},imageWrapper:{flex:"0 0 30%",aspectRatio:"1",maxWidth:"90px",borderRadius:"8px",overflow:"hidden",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb"},productImage:{width:"100%",height:"100%",objectFit:"cover"},productInfo:{flex:"0 0 70%",display:"flex",flexDirection:"column",gap:"4px",minWidth:0},productTitle:{fontSize:"13px",fontWeight:"600",lineHeight:"1.4",color:"#111827",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,overflow:"hidden"},priceRow:{display:"flex",alignItems:"baseline",gap:"6px",marginTop:"4px",flexWrap:"wrap"},finalPrice:{fontSize:"16px",fontWeight:"800",color:"#111827"},originalPrice:{fontSize:"12px",color:"#9ca3af",textDecoration:"line-through"},discountBadge:{fontSize:"11px",fontWeight:"700",color:"#dc2626",backgroundColor:"#fef2f2",padding:"2px 5px",borderRadius:"4px"},shippingText:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},sectionHeader:{fontSize:"13px",fontWeight:"700",color:"#374151",marginBottom:"6px",display:"flex",alignItems:"center",gap:"4px"},benefitsSection:{backgroundColor:"#ffffff",borderRadius:"10px",padding:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},benefitsList:{display:"flex",flexDirection:"column",gap:"8px"},benefitItem:{display:"flex",alignItems:"flex-start",gap:"8px",padding:"8px 10px",backgroundColor:"#f9fafb",borderRadius:"8px"},benefitRank:{fontSize:"11px",fontWeight:"700",color:"#ffffff",backgroundColor:"#393E44",borderRadius:"50%",width:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},benefitContent:{display:"flex",flexDirection:"column",gap:"2px",flex:1,minWidth:0},benefitCardName:{fontSize:"12px",fontWeight:"600",color:"#111827"},benefitDesc:{fontSize:"11px",color:"#6b7280",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},additionalBenefitsSection:{backgroundColor:"#ffffff",borderRadius:"10px",padding:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},additionalBenefitItem:{display:"flex",alignItems:"center",gap:"10px",padding:"8px",backgroundColor:"#fef3c7",borderRadius:"8px",marginTop:"6px"},additionalBenefitIcon:{fontSize:"16px",flexShrink:0},additionalBenefitText:{fontSize:"12px",fontWeight:"600",color:"#92400e"},variantsSection:{backgroundColor:"#ffffff",borderRadius:"10px",padding:"12px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},variantsScrollContainer:{display:"flex",gap:"8px",overflowX:"auto",paddingBottom:"4px",scrollbarWidth:"thin",scrollbarColor:"#d1d5db transparent"},variantItem:{flexShrink:0,padding:"10px 12px",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb",cursor:"pointer",transition:"all 0.2s",minWidth:"100px",textAlign:"center"},variantItemSelected:{flexShrink:0,padding:"10px 12px",backgroundColor:"#393E44",borderRadius:"8px",border:"1px solid #393E44",cursor:"pointer",transition:"all 0.2s",minWidth:"100px",textAlign:"center"},variantLabel:{fontSize:"12px",fontWeight:"600",color:"#374151",marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},variantLabelSelected:{fontSize:"12px",fontWeight:"600",color:"#ffffff",marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},variantPrice:{fontSize:"11px",fontWeight:"700",color:"#111827"},variantPriceSelected:{fontSize:"11px",fontWeight:"700",color:"#ffffff"},emptyState:{padding:"16px",textAlign:"center",color:"#9ca3af",fontSize:"13px"}},H={coupang:"ì¿ íŒ¡",amazon:"ì•„ë§ˆì¡´",ebay:"ì´ë² ì´",gmarket:"Gë§ˆì¼“","11st":"11ë²ˆê°€",naver:"ë„¤ì´ë²„ì‡¼í•‘",tmon:"í‹°ëª¬",wemakeprice:"ìœ„ë©”í”„"},U=()=>{const s=f.useRef(null),{product:t,loading:r}=F();O({enabled:!r,contentRef:s});const d=f.useMemo(()=>t?.cardBenefits?t.cardBenefits.slice(0,3):[],[t?.cardBenefits]),i=f.useMemo(()=>t?.variants?t.variants.slice(0,6):[],[t?.variants]);if(r||!t)return null;const o=t.originalPrice||0,m=t.discountPrice||t.amount||0,a=o>0?Math.round((o-m)/o*100):0,g=t.platform?H[t.platform.toLowerCase()]||t.platform:"ì‡¼í•‘",p=chrome.runtime.getURL("assets/icon/picsel-logo.png"),c=t.cashback&&t.cashback>0,u=t.giftCardDiscount&&t.giftCardDiscount>0,h=c||u;return e.jsxs("div",{ref:s,style:n.wrapper,children:[e.jsxs("div",{style:n.header,children:[e.jsxs("div",{style:n.logoWrapper,children:[e.jsx("img",{src:p,alt:"PicSel",style:n.logo,onError:l=>{l.currentTarget.style.display="none"}}),e.jsxs("span",{style:n.title,children:[g," í˜œíƒ ì •ë³´"]})]}),e.jsx("button",{style:n.closeBtn,onClick:()=>window.close(),children:"âœ•"})]}),e.jsxs("div",{style:n.content,children:[e.jsxs("div",{style:n.productSection,children:[e.jsx("div",{style:n.imageWrapper,children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:"Product",style:n.productImage}):e.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af",fontSize:"12px"},children:"No Image"})}),e.jsxs("div",{style:n.productInfo,children:[e.jsx("div",{style:n.productTitle,children:t.title||"ìƒí’ˆëª… ì—†ìŒ"}),e.jsxs("div",{style:n.priceRow,children:[e.jsxs("span",{style:n.finalPrice,children:["â‚©",m.toLocaleString()]}),o>0&&o!==m&&e.jsxs("span",{style:n.originalPrice,children:["â‚©",o.toLocaleString()]}),a>0&&e.jsxs("span",{style:n.discountBadge,children:["-",a,"%"]})]}),t.shipping&&e.jsxs("span",{style:n.shippingText,children:["ë°°ì†¡: ",t.shipping]})]})]}),d.length>0&&e.jsxs("div",{style:n.benefitsSection,children:[e.jsxs("div",{style:n.sectionHeader,children:[e.jsx(M,{size:14}),"ì¹´ë“œ í˜œíƒ TOP"]}),e.jsx("div",{style:n.benefitsList,children:d.map((l,x)=>e.jsxs("div",{style:n.benefitItem,children:[e.jsx("div",{style:n.benefitRank,children:x+1}),e.jsxs("div",{style:n.benefitContent,children:[e.jsx("div",{style:n.benefitCardName,children:l.cardName||"ì¹´ë“œ"}),e.jsx("div",{style:n.benefitDesc,children:l.discountType==="percentage"?`${l.discountAmount}% í• ì¸`:l.discountType==="amount"?`${l.discountAmount?.toLocaleString()}ì› í• ì¸`:l.description||"í˜œíƒ ì •ë³´"})]})]},x))})]}),h&&e.jsxs("div",{style:n.additionalBenefitsSection,children:[e.jsxs("div",{style:n.sectionHeader,children:[e.jsx(A,{size:14}),"ì¶”ê°€ í˜œíƒ"]}),c&&e.jsxs("div",{style:n.additionalBenefitItem,children:[e.jsx("span",{style:n.additionalBenefitIcon,children:"ğŸ’°"}),e.jsxs("span",{style:n.additionalBenefitText,children:["ìºì‹œë°± ",t.cashback?.toLocaleString(),"ì› ì ë¦½"]})]}),u&&e.jsxs("div",{style:n.additionalBenefitItem,children:[e.jsx("span",{style:n.additionalBenefitIcon,children:"ğŸ"}),e.jsxs("span",{style:n.additionalBenefitText,children:["ê¸°í”„íŠ¸ì¹´ë“œ ",t.giftCardDiscount?.toLocaleString(),"ì› í• ì¸"]})]})]}),i.length>0&&e.jsxs("div",{style:n.variantsSection,children:[e.jsx("div",{style:n.sectionHeader,children:"ë‹¤ë¥¸ êµ¬ì„±"}),e.jsx("div",{style:n.variantsScrollContainer,children:i.map((l,x)=>{const y=l.isSelected||!1;return e.jsxs("div",{style:y?n.variantItemSelected:n.variantItem,children:[e.jsx("div",{style:y?n.variantLabelSelected:n.variantLabel,children:l.name||l.label||`ì˜µì…˜ ${x+1}`}),l.price&&e.jsxs("div",{style:y?n.variantPriceSelected:n.variantPrice,children:["â‚©",l.price.toLocaleString()]})]},x)})})]}),d.length===0&&!h&&i.length===0&&e.jsx("div",{style:n.emptyState,children:"ì´ ìƒí’ˆì— ëŒ€í•œ ì¶”ê°€ í˜œíƒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})]})]})},$=new URLSearchParams(window.location.search),w=$.get("auto")==="true";console.log(`ğŸª [SubPopup] Mode: ${w?"Auto":"Manual"}`);const j=document.getElementById("root");j&&C.createRoot(j).render(e.jsx(I.StrictMode,{children:w?e.jsx(U,{}):e.jsx(E,{})}));
