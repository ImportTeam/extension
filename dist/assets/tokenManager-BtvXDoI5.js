const n="picsel_auth_token";const t={async saveToken(e){return new Promise((r,o)=>{chrome.storage.local.set({[n]:e},()=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message)):r()})})},async getToken(){return new Promise(e=>{chrome.storage.local.get(n,r=>{const o=r[n];e(o||null)})})},isTokenValid(e){return e?e.expiresAt>Date.now():!1},shouldRefreshToken(e){return e?e.expiresAt-Date.now()<3e5:!1},async clearToken(){return new Promise((e,r)=>{chrome.storage.local.remove(n,()=>{chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):e()})})},async cleanupExpiredToken(){const e=await this.getToken();e&&!this.isTokenValid(e)&&await this.clearToken()}};export{t as T};
