import{r as g,j as e,c as P,R as k}from"./client-CWBlmkDm.js";import{c as M,p as T,a as r}from"./colors-xatJuidx.js";const z={getItem:async n=>new Promise(t=>{chrome.storage.local.get([n],o=>{t(o[n]??null)})}),setItem:async(n,t)=>new Promise(o=>{chrome.storage.local.set({[n]:t},()=>{o()})}),removeItem:async n=>new Promise(t=>{chrome.storage.local.remove([n],()=>{t()})})},j=M()(T(n=>({isOpen:!1,activeTab:"list",isLoading:!1,error:null,customMethods:[],setIsOpen:t=>n({isOpen:t}),setActiveTab:t=>n({activeTab:t}),addPaymentMethod:t=>{const o=Date.now(),p={...t,createdAt:o,updatedAt:o,isCustom:!0};n(s=>({customMethods:[...s.customMethods,p]}))},updatePaymentMethod:(t,o)=>{n(p=>({customMethods:p.customMethods.map(s=>s.id===t?{...s,...o,updatedAt:Date.now()}:s)}))},deletePaymentMethod:t=>{n(o=>({customMethods:o.customMethods.filter(p=>p.id!==t)}))},setCustomMethods:t=>{n({customMethods:t})},reset:()=>{n({isOpen:!1,activeTab:"list",isLoading:!1,error:null,customMethods:[]})}}),{name:"subpopup-store",storage:z,partialize:n=>({customMethods:n.customMethods})})),W=()=>j(n=>n.activeTab),A=()=>j(n=>n.customMethods),S=()=>j(n=>({setIsOpen:n.setIsOpen,setActiveTab:n.setActiveTab,addPaymentMethod:n.addPaymentMethod,updatePaymentMethod:n.updatePaymentMethod,deletePaymentMethod:n.deletePaymentMethod,setCustomMethods:n.setCustomMethods,reset:n.reset})),D=()=>{const{addPaymentMethod:n}=S(),[t,o]=g.useState(!1),[p,s]=g.useState(null),[c,u]=g.useState(!1),[a,x]=g.useState({id:"",name:"",savingAmount:0,fee:.8,baseFee:.8,confidence:.8,hasInstallment:!1,installmentInfo:""}),m=h=>{const{name:l,value:d,type:y}=h.target;x(v=>({...v,[l]:y==="checkbox"?h.target.checked:y==="number"?parseFloat(d)||0:d}))},f=()=>a.id.trim()?a.name.trim()?a.savingAmount<0?(s("ì ˆì•½ ê¸ˆì•¡ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤."),!1):a.fee<0||a.fee>100?(s("ìˆ˜ìˆ˜ë£ŒëŠ” 0 ~ 100 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."),!1):a.confidence<0||a.confidence>1?(s("ì‹ ë¢°ë„ëŠ” 0 ~ 1 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."),!1):!0:(s("ê²°ì œ ìˆ˜ë‹¨ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."),!1):(s("ê²°ì œ ìˆ˜ë‹¨ IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."),!1),b=async h=>{if(h.preventDefault(),s(null),u(!1),!!f()){o(!0);try{await new Promise(d=>setTimeout(d,500));const l={id:`custom-${Date.now()}`,name:a.name,savingAmount:a.savingAmount,fee:a.fee,baseFee:a.baseFee,confidence:a.confidence,hasInstallment:a.hasInstallment,installmentInfo:a.installmentInfo||void 0};n(l),u(!0),x({id:"",name:"",savingAmount:0,fee:.8,baseFee:.8,confidence:.8,hasInstallment:!1,installmentInfo:""}),setTimeout(()=>u(!1),3e3)}catch(l){s(l instanceof Error?l.message:"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{o(!1)}}};return e.jsxs("form",{className:"form-section",onSubmit:b,children:[p&&e.jsxs("div",{className:"error-message",children:[e.jsx("strong",{children:"âš ï¸ ì˜¤ë¥˜"}),e.jsx("div",{style:{marginTop:"4px"},children:p})]}),c&&e.jsxs("div",{className:"success-message",children:[e.jsx("strong",{children:"âœ“ ì™„ë£Œ!"}),e.jsx("div",{style:{marginTop:"4px"},children:"ê²°ì œ ìˆ˜ë‹¨ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤"})]}),e.jsx("div",{style:{fontSize:"12px",fontWeight:"700",color:"var(--color-primary)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"var(--spacing-lg)",paddingBottom:"var(--spacing-md)",borderBottom:"2px solid var(--color-primary-lighter)"},children:"ê²°ì œ ìˆ˜ë‹¨ ì •ë³´"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ê²°ì œ ìˆ˜ë‹¨ ì´ë¦„"}),e.jsx("input",{type:"text",name:"name",className:"form-input",placeholder:"ì˜ˆ: ì‹ í•œì¹´ë“œ, í† ìŠ¤ë¨¸ë‹ˆ",value:a.name,onChange:m,disabled:t}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ ì‚¬ìš©ìì—ê²Œ í‘œì‹œë  ê²°ì œ ìˆ˜ë‹¨ ì´ë¦„"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ì˜ˆìƒ ì ˆì•½ ê¸ˆì•¡"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e.jsx("input",{type:"number",name:"savingAmount",className:"form-input",placeholder:"0",value:a.savingAmount,onChange:m,disabled:t,min:"0",style:{flex:1}}),e.jsx("span",{style:{color:"var(--color-text-tertiary)",fontWeight:"600"},children:"ì›"})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ ì´ ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ ì‹œ ì ˆì•½ ê°€ëŠ¥í•œ ê¸ˆì•¡"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ìˆ˜ìˆ˜ë£Œìœ¨"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e.jsx("input",{type:"number",name:"fee",className:"form-input",placeholder:"0.5",value:a.fee,onChange:m,disabled:t,min:"0",max:"100",step:"0.1",style:{flex:1}}),e.jsx("span",{style:{color:"var(--color-text-tertiary)",fontWeight:"600"},children:"%"})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ í˜„ì¬ ìˆ˜ìˆ˜ë£Œ"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ê¸°ì¤€ ìˆ˜ìˆ˜ë£Œ"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e.jsx("input",{type:"number",name:"baseFee",className:"form-input",placeholder:"0.8",value:a.baseFee,onChange:m,disabled:t,min:"0",max:"100",step:"0.1",style:{flex:1}}),e.jsx("span",{style:{color:"var(--color-text-tertiary)",fontWeight:"600"},children:"%"})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ ê¸°ì¤€ ìˆ˜ìˆ˜ë£Œ"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ì‹ ë¢°ë„"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-md)",padding:"var(--spacing-md)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)"},children:[e.jsx("input",{type:"range",name:"confidence",min:"0",max:"1",step:"0.1",value:a.confidence,onChange:m,disabled:t,style:{flex:1,cursor:t?"not-allowed":"pointer",accentColor:"var(--color-primary)"}}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"700",color:"var(--color-primary)",minWidth:"40px",textAlign:"right"},children:[(a.confidence*100).toFixed(0),"%"]})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ 0%ëŠ” ìµœí•˜, 100%ëŠ” ìµœê³  ì‹ ë¢°ë„"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"var(--spacing-md)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)",cursor:t?"not-allowed":"pointer",transition:"all 0.2s ease"},children:[e.jsx("input",{type:"checkbox",name:"hasInstallment",id:"has-installment",checked:a.hasInstallment,onChange:m,disabled:t,style:{accentColor:"var(--color-primary)",cursor:"pointer",marginRight:"var(--spacing-md)",width:"18px",height:"18px"}}),e.jsx("label",{htmlFor:"has-installment",style:{cursor:"pointer",fontSize:"13px",fontWeight:"600",color:"var(--color-text-primary)"},children:"í• ë¶€ ì§€ì›"})]}),a.hasInstallment&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"í• ë¶€ ì •ë³´"}),e.jsx("input",{type:"text",name:"installmentInfo",className:"form-input",placeholder:"ì˜ˆ: 3ê°œì›” ë¬´ì´ì, 6ê°œì›” ì´ìƒ ê°€ëŠ¥",value:a.installmentInfo,onChange:m,disabled:t}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ í• ë¶€ ì˜µì…˜ ìƒì„¸ ì •ë³´"})]}),e.jsx("div",{className:"button-group",style:{marginTop:"var(--spacing-xl)"},children:e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,style:{cursor:t?"not-allowed":"pointer",opacity:t?.7:1},children:t?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner",style:{width:"14px",height:"14px",borderWidth:"2px"}}),"ì €ì¥ ì¤‘..."]}):e.jsx(e.Fragment,{children:"âœ“ ì¶”ê°€í•˜ê¸°"})})})]})},R=()=>{const n=A(),{deletePaymentMethod:t}=S();if(n.length===0)return e.jsxs("div",{className:"payment-list-empty",children:[e.jsx("div",{className:"payment-list-empty-icon",children:"ï¿½ï¸"}),e.jsx("div",{className:"payment-list-empty-text",children:"ì•„ì§ ê²°ì œ ìˆ˜ë‹¨ì´ ì—†ì–´ìš”"}),e.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-tertiary)",marginTop:"8px"},children:"ìƒˆë¡œìš´ ê²°ì œ ìˆ˜ë‹¨ì„ ì¶”ê°€í•´ë³´ì„¸ìš”"})]});const o=s=>{window.confirm("ì •ë§ ì´ ê²°ì œ ìˆ˜ë‹¨ì„ ì‚­ì œí•˜ì‹œê² ì–´ìš”?")&&t(s)},p=s=>{const c=s.toLowerCase();return c.includes("ì¹´ë“œ")?"ğŸ’³":c.includes("ê³„ì¢Œ")||c.includes("ì†¡ê¸ˆ")?"ğŸ¦":c.includes("í¬ì¸íŠ¸")||c.includes("ì¿ í°")?"ğŸ«":c.includes("í˜ì´")||c.includes("pay")?"ğŸ“±":c.includes("í˜„ê¸ˆ")?"ğŸ’µ":"ğŸ’°"};return e.jsx("div",{className:"payment-list",children:n.map(s=>{const c=s.confidence>=.95,u=p(s.name);return e.jsxs("div",{className:"payment-item",children:[e.jsx("div",{className:"payment-item-icon",children:u}),e.jsxs("div",{className:"payment-item-content",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"var(--spacing-md)"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"payment-item-name",children:s.name}),e.jsx("div",{className:"payment-item-meta",children:e.jsx("span",{children:new Date(s.createdAt).toLocaleDateString("ko-KR")})})]}),c&&e.jsx("div",{className:"payment-item-badge success",children:"â­ ìš°ìˆ˜"})]}),e.jsxs("div",{className:"payment-item-info",children:[e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ì ˆì•½ì•¡"}),e.jsxs("span",{className:"payment-item-info-value",children:["â‚©",s.savingAmount.toLocaleString()]})]}),e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ìˆ˜ìˆ˜ë£Œ"}),e.jsxs("span",{className:"payment-item-info-value",children:[s.fee,"%"]})]}),e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ì‹ ë¢°ë„"}),e.jsxs("span",{className:"payment-item-info-value",children:[(s.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ê¸°ë³¸ìˆ˜ìˆ˜ë£Œ"}),e.jsxs("span",{className:"payment-item-info-value",children:[s.baseFee,"%"]})]})]}),s.hasInstallment&&s.installmentInfo&&e.jsxs("div",{style:{fontSize:"12px",padding:"var(--spacing-md)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)",color:"var(--color-text-secondary)",marginBottom:"var(--spacing-md)",borderLeft:"3px solid var(--color-primary-lighter)",fontWeight:"500"},children:[e.jsx("strong",{children:"í• ë¶€ ì •ë³´:"})," ",s.installmentInfo]}),e.jsxs("div",{className:"payment-item-actions",style:{justifyContent:"space-between"},children:[e.jsx("button",{className:"payment-item-btn payment-item-btn-edit",onClick:()=>alert("ìˆ˜ì • ê¸°ëŠ¥ì€ ê³§ ì¶”ê°€ë©ë‹ˆë‹¤."),style:{flex:1},title:"ìˆ˜ì •",children:"âœï¸ ìˆ˜ì •"}),e.jsx("button",{className:"payment-item-btn payment-item-btn-delete",onClick:()=>o(s.id),style:{flex:1},title:"ì‚­ì œ",children:"ğŸ—‘ï¸ ì‚­ì œ"})]})]})]},s.id)})})},L=()=>{const n=W(),{setActiveTab:t}=S();return e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"subpopup-header",children:[e.jsxs("div",{className:"subpopup-header-title",children:[e.jsx("span",{style:{fontSize:"20px",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},children:"ğŸ’³"}),e.jsx("h1",{children:"ê²°ì œ ìˆ˜ë‹¨ ê´€ë¦¬"})]}),e.jsx("button",{className:"subpopup-header-close-btn",onClick:()=>window.close(),title:"ë‹«ê¸°","aria-label":"ì°½ ë‹«ê¸°",children:"âœ•"})]}),e.jsxs("div",{className:"subpopup-tabs",children:[e.jsx("button",{className:`subpopup-tab-btn ${n==="add"?"active":""}`,onClick:()=>t("add"),"aria-selected":n==="add",children:"â• ìƒˆë¡œ ì¶”ê°€"}),e.jsx("button",{className:`subpopup-tab-btn ${n==="list"?"active":""}`,onClick:()=>t("list"),"aria-selected":n==="list",children:"ğŸ“‹ ê´€ë¦¬"})]}),e.jsxs("div",{className:"subpopup-content",style:{animation:"fadeIn 0.2s ease"},children:[n==="add"&&e.jsx(D,{}),n==="list"&&e.jsx(R,{})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(4px); }
          to { opacity: 1; transform: translateY(0); }
        }
      `})]})},F=()=>{const[n,t]=g.useState(null),[o,p]=g.useState([]),[s,c]=g.useState([]),[u,a]=g.useState(!0);return g.useEffect(()=>{(async()=>{var m,f,b,h;try{const l=await chrome.storage.local.get(["currentProduct"]);if(l.currentProduct){const d=l.currentProduct;if(console.log("[useProductData] Loaded product:",{title:(m=d.title)==null?void 0:m.substring(0,50),imageUrl:((f=d.imageUrl)==null?void 0:f.substring(0,80))||"none",imagesCount:((b=d.images)==null?void 0:b.length)||0,variantsCount:((h=d.variants)==null?void 0:h.length)||0}),t(d),Array.isArray(d.cardBenefits)){const v=[...d.cardBenefits].sort((C,I)=>(I.rate||0)-(C.rate||0)).slice(0,3);p(v)}const y=[];d.imageUrl&&y.push(d.imageUrl),Array.isArray(d.images)&&d.images.length>0&&y.push(...d.images.filter(v=>typeof v=="string")),c(y),console.log("[useProductData] Images loaded:",y.length)}}catch(l){console.error("[useProductData] Error:",l)}finally{a(!1)}})()},[]),{product:n,topBenefits:o,imageSlides:s,loading:u}},B=n=>{const[t,o]=g.useState(0);return{currentSlideIdx:t,handlePrevSlide:()=>{n>1&&o(c=>(c-1+n)%n)},handleNextSlide:()=>{n>1&&o(c=>(c+1)%n)}}},E=({enabled:n,contentRef:t})=>{g.useEffect(()=>{if(!n||!t.current)return;const o=()=>{if(!t.current)return;const a=t.current.scrollHeight;console.log("[useWindowResize] Content scroll height:",a);const x=document.querySelector('[style*="flexShrink"]'),m=x?x.clientHeight:52,f=Math.min(m+a+24,900);console.log("[useWindowResize] Calculated total height:",{headerHeight:m,contentHeight:a,totalHeight:f});try{window.resizeTo(420,f),console.log("[useWindowResize] Window resized to:",{width:420,height:f})}catch(b){console.warn("[useWindowResize] Cannot resize window:",b)}};o();const p=new ResizeObserver(()=>{o()});p.observe(t.current);const s=t.current.querySelectorAll("img");let c=0;const u=()=>{c++,c===s.length&&setTimeout(o,100)};return s.forEach(a=>{a.complete?c++:(a.addEventListener("load",u),a.addEventListener("error",u))}),c===s.length&&setTimeout(o,100),()=>{p.disconnect(),s.forEach(a=>{a.removeEventListener("load",u),a.removeEventListener("error",u)})}},[n,t])},i={wrapper:{width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:r.background,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',color:r.textPrimary,overflow:"hidden"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",borderBottom:`1px solid ${r.border}`,backgroundColor:r.backgroundSecondary,flexShrink:0},logoWrapper:{display:"flex",alignItems:"center",gap:"8px"},logo:{width:"28px",height:"28px",objectFit:"contain"},title:{fontSize:"16px",fontWeight:"700",color:r.textPrimary},closeBtn:{background:"none",border:"none",cursor:"pointer",padding:"4px 8px",fontSize:"18px",color:r.textSecondary,borderRadius:"4px",transition:"all 0.2s"},content:{flex:1,overflowY:"auto",padding:"12px",display:"flex",flexDirection:"column",gap:"10px",width:"100%"},productCard:{display:"flex",flexDirection:"column",gap:"12px",padding:"12px",backgroundColor:r.backgroundSecondary,borderRadius:"8px",borderLeft:`3px solid ${r.textSecondary}`},imageCarousel:{position:"relative",width:"100%",aspectRatio:"1.5",borderRadius:"6px",overflow:"hidden",backgroundColor:r.background,display:"flex",alignItems:"center",justifyContent:"center"},productImage:{width:"100%",height:"100%",objectFit:"cover",objectPosition:"center",display:"block"},carouselBtn:{position:"absolute",top:"50%",left:"8px",transform:"translateY(-50%)",backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",border:"none",borderRadius:"50%",width:"28px",height:"28px",fontSize:"18px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s",zIndex:10},indicators:{position:"absolute",bottom:"8px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"6px",zIndex:10},indicator:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"white",transition:"opacity 0.3s"},infoWrapper:{display:"flex",flexDirection:"column",gap:"8px"},title3:{margin:"0",fontSize:"12px",fontWeight:"700",lineHeight:"1.4",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,overflow:"hidden",color:r.textPrimary},priceGroup:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},originalPrice:{fontSize:"11px",color:r.textSecondary,textDecoration:"line-through"},discountTag:{fontSize:"11px",fontWeight:"700",backgroundColor:r.accent,color:r.textPrimary,padding:"2px 6px",borderRadius:"3px"},finalPrice:{fontSize:"15px",fontWeight:"800",color:r.textPrimary,width:"100%"},shippingInfo:{fontSize:"10px",color:r.textSecondary,fontWeight:"600"},benefitsSection:{display:"flex",flexDirection:"column",gap:"6px"},sectionTitle:{margin:"0",fontSize:"11px",fontWeight:"700",textTransform:"uppercase",color:r.textSecondary,opacity:.7},benefitCard:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 10px",backgroundColor:r.backgroundSecondary,borderRadius:"6px",fontSize:"11px"},benefitInfo:{display:"flex",flexDirection:"column",gap:"2px",flex:1},cardName:{fontWeight:"600",color:r.textPrimary},benefitText:{fontSize:"10px",color:r.textSecondary},rateTag:{fontSize:"11px",fontWeight:"700",backgroundColor:r.accent,color:r.textPrimary,padding:"2px 8px",borderRadius:"4px",marginLeft:"8px",flexShrink:0},extraSection:{display:"flex",flexDirection:"column",gap:"6px",paddingTop:"6px",borderTop:`1px solid ${r.border}`},extraItem:{padding:"8px 10px",backgroundColor:r.backgroundSecondary,borderRadius:"6px",fontSize:"11px",color:r.textPrimary,fontWeight:"500"},variantsSection:{display:"flex",flexDirection:"column",gap:"8px",paddingTop:"6px",borderTop:`1px solid ${r.border}`},variantsScroll:{display:"flex",gap:"8px",overflowX:"auto",paddingBottom:"4px",scrollBehavior:"smooth"},variantCard:{display:"flex",flexDirection:"column",gap:"4px",padding:"8px 12px",backgroundColor:r.backgroundSecondary,borderRadius:"6px",fontSize:"10px",whiteSpace:"nowrap",minWidth:"100px",border:`1px solid ${r.border}`,flex:"0 0 auto"},variantName:{fontSize:"10px",fontWeight:"600",color:r.textSecondary},variantPrice:{fontSize:"12px",fontWeight:"700",color:r.textPrimary},variantDiscount:{fontSize:"9px",fontWeight:"700",backgroundColor:r.accent,color:r.textPrimary,padding:"1px 4px",borderRadius:"2px",alignSelf:"flex-start"}},O=()=>{const n=g.useRef(null),{product:t,topBenefits:o,imageSlides:p,loading:s}=F(),{currentSlideIdx:c,handlePrevSlide:u,handleNextSlide:a}=B(p.length);if(E({enabled:!s,contentRef:n}),s||!t)return null;const x=t.originalPrice||0,m=t.discountPrice||t.amount||0,f=x>0?Math.round((x-m)/x*100):0,b=chrome.runtime.getURL("assets/icon/picsel-logo.png"),h=p[c];return e.jsxs("div",{ref:n,style:i.wrapper,children:[e.jsxs("div",{style:i.header,children:[e.jsxs("div",{style:i.logoWrapper,children:[e.jsx("img",{src:b,alt:"PicSel",style:i.logo,onError:l=>{l.currentTarget.style.display="none"}}),e.jsx("span",{style:i.title,children:"PicSel"})]}),e.jsx("button",{style:i.closeBtn,onClick:()=>window.close(),children:"âœ•"})]}),e.jsxs("div",{style:i.content,children:[e.jsxs("div",{style:i.productCard,children:[h&&e.jsxs("div",{style:i.imageCarousel,children:[e.jsx("img",{src:h,alt:"Product image",style:i.productImage,onError:l=>{console.error("[AutoNotification] Image failed:",h),l.currentTarget.style.display="none"},onLoad:()=>{console.log("[AutoNotification] Image loaded:",h)}}),p.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{style:i.carouselBtn,onClick:u,"aria-label":"ì´ì „",children:"â€¹"}),e.jsx("button",{style:{...i.carouselBtn,right:"8px"},onClick:a,"aria-label":"ë‹¤ìŒ",children:"â€º"}),e.jsx("div",{style:i.indicators,children:p.map((l,d)=>e.jsx("div",{style:{...i.indicator,opacity:d===c?1:.4}},d))})]})]}),e.jsxs("div",{style:i.infoWrapper,children:[e.jsx("h3",{style:i.title3,children:t.title}),e.jsxs("div",{style:i.priceGroup,children:[x>0&&x!==m?e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:i.originalPrice,children:["â‚©",x.toLocaleString()]}),f>0&&e.jsxs("span",{style:i.discountTag,children:["-",f,"%"]})]}):null,e.jsxs("div",{style:i.finalPrice,children:["â‚©",m.toLocaleString()]})]}),t.shippingInfo&&e.jsxs("span",{style:i.shippingInfo,children:["ğŸ“¦ ",t.shippingInfo]})]})]}),o.length>0&&e.jsxs("div",{style:i.benefitsSection,children:[e.jsxs("h4",{style:i.sectionTitle,children:["ğŸ’³ ì¹´ë“œí˜œíƒ TOP",o.length]}),o.map((l,d)=>e.jsxs("div",{style:i.benefitCard,children:[e.jsxs("div",{style:i.benefitInfo,children:[e.jsx("span",{style:i.cardName,children:l.cardName}),l.benefit&&e.jsx("span",{style:i.benefitText,children:l.benefit})]}),l.rate&&e.jsxs("span",{style:i.rateTag,children:[l.rate,"%"]})]},d))]}),(t.giftCardDiscount||t.cashback)&&e.jsxs("div",{style:i.extraSection,children:[t.giftCardDiscount&&e.jsxs("div",{style:i.extraItem,children:["ğŸ ",t.giftCardDiscount.description]}),t.cashback&&e.jsxs("div",{style:i.extraItem,children:["ğŸ’° ",t.cashback.description]})]}),t.variants&&t.variants.length>0&&e.jsxs("div",{style:i.variantsSection,children:[e.jsx("h4",{style:i.sectionTitle,children:"ğŸ“¦ ë‹¤ë¥¸ êµ¬ì„±"}),e.jsx("div",{style:i.variantsScroll,children:t.variants.map((l,d)=>{var y;return e.jsxs("div",{style:i.variantCard,children:[e.jsx("span",{style:i.variantName,children:l.name}),e.jsxs("span",{style:i.variantPrice,children:["â‚©",(y=l.price)==null?void 0:y.toLocaleString()]}),l.discount&&e.jsx("span",{style:i.variantDiscount,children:l.discount})]},d)})})]})]})]})},$=new URLSearchParams(window.location.search),w=$.get("auto")==="true";console.log(`ğŸª [SubPopup] Mode: ${w?"Auto":"Manual"}`);const N=document.getElementById("root");N&&P.createRoot(N).render(e.jsx(k.StrictMode,{children:w?e.jsx(O,{}):e.jsx(L,{})}));
