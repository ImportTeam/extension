import{r,c as S,p as M,a as w,S as g,M as p}from"./chromeStorage-8YJmZKR_.js";import{s as h,E as y}from"./index-CtnQ7lw9.js";const v=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),I=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,o,a)=>a?a.toUpperCase():o.toLowerCase()),f=e=>{const t=I(e);return t.charAt(0).toUpperCase()+t.slice(1)},C=(...e)=>e.filter((t,o,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===o).join(" ").trim(),x=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var L={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const T=r.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:o=2,absoluteStrokeWidth:a,className:s="",children:n,iconNode:E,...u},P)=>r.createElement("svg",{ref:P,...L,width:t,height:t,stroke:e,strokeWidth:a?Number(o)*24/Number(t):o,className:C("lucide",s),...!n&&!x(u)&&{"aria-hidden":"true"},...u},[...E.map(([b,A])=>r.createElement(b,A)),...Array.isArray(n)?n:[n]]));const U=(e,t)=>{const o=r.forwardRef(({className:a,...s},n)=>r.createElement(T,{ref:n,iconNode:t,className:C(`lucide-${v(f(e))}`,`lucide-${e}`,a),...s}));return o.displayName=f(e),o};const B=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],G=U("x",B),i={isLoading:!1,isExpanded:!1,showPaymentMethod:!1,selectedTab:"recommendation",error:null},c={recommendation:null,alternatives:[],discounts:null,cardBenefits:null},d={timestamp:0,siteId:void 0},D=e=>({...i,setLoading:t=>{e({isLoading:t})},toggleExpanded:()=>{e(t=>({isExpanded:!t.isExpanded}))},setShowPaymentMethod:t=>{e({showPaymentMethod:t})},setSelectedTab:t=>{e({selectedTab:t})},setError:t=>{e({error:t})},resetUI:()=>{e(i)}}),O=e=>({...c,setRecommendation:t=>{e({recommendation:t})},setAlternatives:t=>{e({alternatives:t})},setDiscounts:t=>{e({discounts:t})},setCardBenefits:t=>{e({cardBenefits:t})},resetData:()=>{e(c)}}),k=e=>({...d,updateTimestamp:()=>{e({timestamp:Date.now()})},setSiteId:t=>{e({siteId:t})},resetMeta:()=>{e(d)}}),R=S()(M((...e)=>({...D(...e),...O(...e),...k(...e),reset:()=>{const[t]=e;t({...i,...c,...d})}}),{name:g.RECOMMENDATION,storage:w(),partialize:e=>({recommendation:e.recommendation,alternatives:e.alternatives,discounts:e.discounts,cardBenefits:e.cardBenefits,siteId:e.siteId,timestamp:e.timestamp}),onRehydrateStorage:()=>(e,t)=>{if(t){h.error(y.STO_E003,"Store rehydration failed",{error:t instanceof Error?t:new Error(String(t))});return}if(e&&e.timestamp){const o=Date.now()-e.timestamp;o>p&&(h.info("ðŸ”„ Cache expired, resetting recommendation store",{age:`${Math.floor(o/1e3)}s`,maxAge:`${p/1e3}s`}),R.setState({recommendation:null,alternatives:[],discounts:null,cardBenefits:null}))}}})),m={isOpen:!1,activeTab:"list",isLoading:!1,error:null},l={customMethods:[]},_=e=>({...m,setIsOpen:t=>{e({isOpen:t})},setActiveTab:t=>{e({activeTab:t})},setIsLoading:t=>{e({isLoading:t})},setError:t=>{e({error:t})},resetUI:()=>{e(m)}}),$=e=>({...l,addPaymentMethod:t=>{const o=Date.now(),a={...t,createdAt:o,updatedAt:o,isCustom:!0};e(s=>({customMethods:[...s.customMethods,a]}))},updatePaymentMethod:(t,o)=>{e(a=>({customMethods:a.customMethods.map(s=>s.id===t?{...s,...o,updatedAt:Date.now()}:s)}))},deletePaymentMethod:t=>{e(o=>({customMethods:o.customMethods.filter(a=>a.id!==t)}))},setCustomMethods:t=>{e({customMethods:t})},resetPayment:()=>{e(l)}}),K=S()(M((...e)=>({..._(...e),...$(...e),reset:()=>{const[t]=e;t({...m,...l})}}),{name:g.SUBPOPUP,storage:w(),partialize:e=>({customMethods:e.customMethods})}));export{G as X,K as a,U as c,R as u};
