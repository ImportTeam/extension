import{r as h,j as e,R as I,a as C}from"./client-5jyeqxZ7.js";import{c as y,a as M,p as P,X as A}from"./middleware-BemgEyhy.js";const z=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],B=y("award",z);const W=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],R=y("coins",W);const T=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],k=y("credit-card",T);const D=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],L=y("gift",D),F={getItem:async s=>new Promise(t=>{chrome.storage.local.get([s],l=>{t(l[s]??null)})}),setItem:async(s,t)=>new Promise(l=>{chrome.storage.local.set({[s]:t},()=>{l()})}),removeItem:async s=>new Promise(t=>{chrome.storage.local.remove([s],()=>{t()})})},v=M()(P(s=>({isOpen:!1,activeTab:"list",isLoading:!1,error:null,customMethods:[],setIsOpen:t=>{s({isOpen:t})},setActiveTab:t=>{s({activeTab:t})},addPaymentMethod:t=>{const l=Date.now(),m={...t,createdAt:l,updatedAt:l,isCustom:!0};s(n=>({customMethods:[...n.customMethods,m]}))},updatePaymentMethod:(t,l)=>{s(m=>({customMethods:m.customMethods.map(n=>n.id===t?{...n,...l,updatedAt:Date.now()}:n)}))},deletePaymentMethod:t=>{s(l=>({customMethods:l.customMethods.filter(m=>m.id!==t)}))},setCustomMethods:t=>{s({customMethods:t})},reset:()=>{s({isOpen:!1,activeTab:"list",isLoading:!1,error:null,customMethods:[]})}}),{name:"subpopup-store",storage:F,partialize:s=>({customMethods:s.customMethods})})),E=()=>v(s=>s.activeTab),H=()=>v(s=>s.customMethods),b=()=>v(s=>({setIsOpen:s.setIsOpen,setActiveTab:s.setActiveTab,addPaymentMethod:s.addPaymentMethod,updatePaymentMethod:s.updatePaymentMethod,deletePaymentMethod:s.deletePaymentMethod,setCustomMethods:s.setCustomMethods,reset:s.reset})),O=()=>{const{addPaymentMethod:s}=b(),[t,l]=h.useState(!1),[m,n]=h.useState(null),[c,p]=h.useState(!1),[a,g]=h.useState({id:"",name:"",savingAmount:0,fee:.8,baseFee:.8,confidence:.8,hasInstallment:!1,installmentInfo:""}),r=f=>{const{name:u,value:x,type:j}=f.target;g(S=>({...S,[u]:j==="checkbox"?f.target.checked:j==="number"?parseFloat(x)||0:x}))},o=()=>a.id.trim()?a.name.trim()?a.savingAmount<0?(n("ì ˆì•½ ê¸ˆì•¡ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤."),!1):a.fee<0||a.fee>100?(n("ìˆ˜ìˆ˜ë£ŒëŠ” 0 ~ 100 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."),!1):a.confidence<0||a.confidence>1?(n("ì‹ ë¢°ë„ëŠ” 0 ~ 1 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."),!1):!0:(n("ê²°ì œ ìˆ˜ë‹¨ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."),!1):(n("ê²°ì œ ìˆ˜ë‹¨ IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."),!1),d=async f=>{if(f.preventDefault(),n(null),p(!1),!!o()){l(!0);try{await new Promise(x=>setTimeout(x,500));const u={id:`custom-${Date.now()}`,name:a.name,savingAmount:a.savingAmount,fee:a.fee,baseFee:a.baseFee,confidence:a.confidence,hasInstallment:a.hasInstallment,installmentInfo:a.installmentInfo||void 0};s(u),p(!0),g({id:"",name:"",savingAmount:0,fee:.8,baseFee:.8,confidence:.8,hasInstallment:!1,installmentInfo:""}),setTimeout(()=>p(!1),3e3)}catch(u){n(u instanceof Error?u.message:"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{l(!1)}}};return e.jsxs("form",{className:"form-section",onSubmit:d,children:[m&&e.jsxs("div",{className:"error-message",children:[e.jsx("strong",{children:"âš ï¸ ì˜¤ë¥˜"}),e.jsx("div",{style:{marginTop:"4px"},children:m})]}),c&&e.jsxs("div",{className:"success-message",children:[e.jsx("strong",{children:"âœ“ ì™„ë£Œ!"}),e.jsx("div",{style:{marginTop:"4px"},children:"ê²°ì œ ìˆ˜ë‹¨ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤"})]}),e.jsx("div",{style:{fontSize:"12px",fontWeight:"700",color:"var(--color-primary)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"var(--spacing-lg)",paddingBottom:"var(--spacing-md)",borderBottom:"2px solid var(--color-primary-lighter)"},children:"ê²°ì œ ìˆ˜ë‹¨ ì •ë³´"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ê²°ì œ ìˆ˜ë‹¨ ì´ë¦„"}),e.jsx("input",{type:"text",name:"name",className:"form-input",placeholder:"ì˜ˆ: ì‹ í•œì¹´ë“œ, í† ìŠ¤ë¨¸ë‹ˆ",value:a.name,onChange:r,disabled:t}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ ì‚¬ìš©ìì—ê²Œ í‘œì‹œë  ê²°ì œ ìˆ˜ë‹¨ ì´ë¦„"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ì˜ˆìƒ ì ˆì•½ ê¸ˆì•¡"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e.jsx("input",{type:"number",name:"savingAmount",className:"form-input",placeholder:"0",value:a.savingAmount,onChange:r,disabled:t,min:"0",style:{flex:1}}),e.jsx("span",{style:{color:"var(--color-text-tertiary)",fontWeight:"600"},children:"ì›"})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ ì´ ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ ì‹œ ì ˆì•½ ê°€ëŠ¥í•œ ê¸ˆì•¡"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ìˆ˜ìˆ˜ë£Œìœ¨"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e.jsx("input",{type:"number",name:"fee",className:"form-input",placeholder:"0.5",value:a.fee,onChange:r,disabled:t,min:"0",max:"100",step:"0.1",style:{flex:1}}),e.jsx("span",{style:{color:"var(--color-text-tertiary)",fontWeight:"600"},children:"%"})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ í˜„ì¬ ìˆ˜ìˆ˜ë£Œ"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ê¸°ì¤€ ìˆ˜ìˆ˜ë£Œ"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e.jsx("input",{type:"number",name:"baseFee",className:"form-input",placeholder:"0.8",value:a.baseFee,onChange:r,disabled:t,min:"0",max:"100",step:"0.1",style:{flex:1}}),e.jsx("span",{style:{color:"var(--color-text-tertiary)",fontWeight:"600"},children:"%"})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ ê¸°ì¤€ ìˆ˜ìˆ˜ë£Œ"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ì‹ ë¢°ë„"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-md)",padding:"var(--spacing-md)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)"},children:[e.jsx("input",{type:"range",name:"confidence",min:"0",max:"1",step:"0.1",value:a.confidence,onChange:r,disabled:t,style:{flex:1,cursor:t?"not-allowed":"pointer",accentColor:"var(--color-primary)"}}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"700",color:"var(--color-primary)",minWidth:"40px",textAlign:"right"},children:[(a.confidence*100).toFixed(0),"%"]})]}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ 0%ëŠ” ìµœí•˜, 100%ëŠ” ìµœê³  ì‹ ë¢°ë„"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"var(--spacing-md)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)",cursor:t?"not-allowed":"pointer",transition:"all 0.2s ease"},children:[e.jsx("input",{type:"checkbox",name:"hasInstallment",id:"has-installment",checked:a.hasInstallment,onChange:r,disabled:t,style:{accentColor:"var(--color-primary)",cursor:"pointer",marginRight:"var(--spacing-md)",width:"18px",height:"18px"}}),e.jsx("label",{htmlFor:"has-installment",style:{cursor:"pointer",fontSize:"13px",fontWeight:"600",color:"var(--color-text-primary)"},children:"í• ë¶€ ì§€ì›"})]}),a.hasInstallment&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"í• ë¶€ ì •ë³´"}),e.jsx("input",{type:"text",name:"installmentInfo",className:"form-input",placeholder:"ì˜ˆ: 3ê°œì›” ë¬´ì´ì, 6ê°œì›” ì´ìƒ ê°€ëŠ¥",value:a.installmentInfo,onChange:r,disabled:t}),e.jsx("div",{className:"form-hint",children:"ğŸ’¡ í• ë¶€ ì˜µì…˜ ìƒì„¸ ì •ë³´"})]}),e.jsx("div",{className:"button-group",style:{marginTop:"var(--spacing-xl)"},children:e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,style:{cursor:t?"not-allowed":"pointer",opacity:t?.7:1},children:t?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner",style:{width:"14px",height:"14px",borderWidth:"2px"}}),"ì €ì¥ ì¤‘..."]}):e.jsx(e.Fragment,{children:"âœ“ ì¶”ê°€í•˜ê¸°"})})})]})},$=()=>{const s=H(),{deletePaymentMethod:t}=b();if(s.length===0)return e.jsxs("div",{className:"payment-list-empty",children:[e.jsx("div",{className:"payment-list-empty-icon",children:"ï¿½ï¸"}),e.jsx("div",{className:"payment-list-empty-text",children:"ì•„ì§ ê²°ì œ ìˆ˜ë‹¨ì´ ì—†ì–´ìš”"}),e.jsx("div",{style:{fontSize:"12px",color:"var(--color-text-tertiary)",marginTop:"8px"},children:"ìƒˆë¡œìš´ ê²°ì œ ìˆ˜ë‹¨ì„ ì¶”ê°€í•´ë³´ì„¸ìš”"})]});const l=n=>{window.confirm("ì •ë§ ì´ ê²°ì œ ìˆ˜ë‹¨ì„ ì‚­ì œí•˜ì‹œê² ì–´ìš”?")&&t(n)},m=n=>{const c=n.toLowerCase();return c.includes("ì¹´ë“œ")?"ğŸ’³":c.includes("ê³„ì¢Œ")||c.includes("ì†¡ê¸ˆ")?"ğŸ¦":c.includes("í¬ì¸íŠ¸")||c.includes("ì¿ í°")?"ğŸ«":c.includes("í˜ì´")||c.includes("pay")?"ğŸ“±":c.includes("í˜„ê¸ˆ")?"ğŸ’µ":"ğŸ’°"};return e.jsx("div",{className:"payment-list",children:s.map(n=>{const c=n.confidence>=.95,p=m(n.name);return e.jsxs("div",{className:"payment-item",children:[e.jsx("div",{className:"payment-item-icon",children:p}),e.jsxs("div",{className:"payment-item-content",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"var(--spacing-md)"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"payment-item-name",children:n.name}),e.jsx("div",{className:"payment-item-meta",children:e.jsx("span",{children:new Date(n.createdAt).toLocaleDateString("ko-KR")})})]}),c&&e.jsx("div",{className:"payment-item-badge success",children:"â­ ìš°ìˆ˜"})]}),e.jsxs("div",{className:"payment-item-info",children:[e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ì ˆì•½ì•¡"}),e.jsxs("span",{className:"payment-item-info-value",children:["â‚©",n.savingAmount.toLocaleString()]})]}),e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ìˆ˜ìˆ˜ë£Œ"}),e.jsxs("span",{className:"payment-item-info-value",children:[n.fee,"%"]})]}),e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ì‹ ë¢°ë„"}),e.jsxs("span",{className:"payment-item-info-value",children:[(n.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"payment-item-info-item",children:[e.jsx("span",{className:"payment-item-info-label",children:"ê¸°ë³¸ìˆ˜ìˆ˜ë£Œ"}),e.jsxs("span",{className:"payment-item-info-value",children:[n.baseFee,"%"]})]})]}),n.hasInstallment&&n.installmentInfo&&e.jsxs("div",{style:{fontSize:"12px",padding:"var(--spacing-md)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)",color:"var(--color-text-secondary)",marginBottom:"var(--spacing-md)",borderLeft:"3px solid var(--color-primary-lighter)",fontWeight:"500"},children:[e.jsx("strong",{children:"í• ë¶€ ì •ë³´:"})," ",n.installmentInfo]}),e.jsxs("div",{className:"payment-item-actions",style:{justifyContent:"space-between"},children:[e.jsx("button",{className:"payment-item-btn payment-item-btn-edit",onClick:()=>alert("ìˆ˜ì • ê¸°ëŠ¥ì€ ê³§ ì¶”ê°€ë©ë‹ˆë‹¤."),style:{flex:1},title:"ìˆ˜ì •",children:"âœï¸ ìˆ˜ì •"}),e.jsx("button",{className:"payment-item-btn payment-item-btn-delete",onClick:()=>l(n.id),style:{flex:1},title:"ì‚­ì œ",children:"ğŸ—‘ï¸ ì‚­ì œ"})]})]})]},n.id)})})},U=()=>{const s=E(),{setActiveTab:t}=b();return e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"subpopup-header",children:[e.jsxs("div",{className:"subpopup-header-title",children:[e.jsx("span",{style:{fontSize:"20px",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},children:"ğŸ’³"}),e.jsx("h1",{children:"ê²°ì œ ìˆ˜ë‹¨ ê´€ë¦¬"})]}),e.jsx("button",{className:"subpopup-header-close-btn",onClick:()=>window.close(),title:"ë‹«ê¸°","aria-label":"ì°½ ë‹«ê¸°",children:"âœ•"})]}),e.jsxs("div",{className:"subpopup-tabs",children:[e.jsx("button",{className:`subpopup-tab-btn ${s==="add"?"active":""}`,onClick:()=>t("add"),"aria-selected":s==="add",children:"â• ìƒˆë¡œ ì¶”ê°€"}),e.jsx("button",{className:`subpopup-tab-btn ${s==="list"?"active":""}`,onClick:()=>t("list"),"aria-selected":s==="list",children:"ğŸ“‹ ê´€ë¦¬"})]}),e.jsxs("div",{className:"subpopup-content",style:{animation:"fadeIn 0.2s ease"},children:[s==="add"&&e.jsx(O,{}),s==="list"&&e.jsx($,{})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(4px); }
          to { opacity: 1; transform: translateY(0); }
        }
      `})]})},_=()=>{const[s,t]=h.useState(null),[l,m]=h.useState([]),[n,c]=h.useState([]),[p,a]=h.useState(!0);return h.useEffect(()=>{(async()=>{try{const r=await chrome.storage.local.get(["currentProduct"]);if(r.currentProduct){const o=r.currentProduct;if(console.log("[useProductData] Loaded product:",{title:o.title?.substring(0,50),imageUrl:o.imageUrl?.substring(0,80)||"none",imagesCount:o.images?.length||0,variantsCount:o.variants?.length||0}),t(o),Array.isArray(o.cardBenefits)){const f=[...o.cardBenefits].sort((u,x)=>(x.rate||0)-(u.rate||0)).slice(0,3);m(f)}const d=[];o.imageUrl&&d.push(o.imageUrl),Array.isArray(o.images)&&o.images.length>0&&d.push(...o.images.filter(f=>typeof f=="string")),c(d),console.log("[useProductData] Images loaded:",d.length)}}catch(r){console.error("[useProductData] Error:",r)}finally{a(!1)}})()},[]),{product:s,topBenefits:l,imageSlides:n,loading:p}},Y=({enabled:s,contentRef:t})=>{h.useEffect(()=>{if(!s||!t.current)return;const l=()=>{if(!t.current)return;const a=t.current.scrollHeight;console.log("[useWindowResize] Content scroll height:",a);const g=document.querySelector('[style*="flexShrink"]'),r=g?g.clientHeight:52,o=Math.min(r+a+24,900);console.log("[useWindowResize] Calculated total height:",{headerHeight:r,contentHeight:a,totalHeight:o});try{window.resizeTo(420,o),console.log("[useWindowResize] Window resized to:",{width:420,height:o})}catch(d){console.warn("[useWindowResize] Cannot resize window:",d)}};l();const m=new ResizeObserver(()=>{l()});m.observe(t.current);const n=t.current.querySelectorAll("img");let c=0;const p=()=>{c++,c===n.length&&setTimeout(l,100)};return n.forEach(a=>{a.complete?c++:(a.addEventListener("load",p),a.addEventListener("error",p))}),c===n.length&&setTimeout(l,100),()=>{m.disconnect(),n.forEach(a=>{a.removeEventListener("load",p),a.removeEventListener("error",p)})}},[s,t])},i={wrapper:{width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#f8fafc",color:"#1e293b",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',overflow:"hidden"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",backgroundColor:"#ffffff",borderBottom:"1px solid #e2e8f0",flexShrink:0},logoWrapper:{display:"flex",alignItems:"center",gap:"8px"},title:{fontSize:"17px",fontWeight:700,color:"#0f172a",letterSpacing:"-0.3px"},closeBtn:{background:"transparent",border:"none",color:"#94a3b8",fontSize:"20px",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",transition:"color 0.2s",borderRadius:"6px"},content:{flex:1,padding:"16px 20px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"20px"},card:{backgroundColor:"#ffffff",borderRadius:"14px",border:"1px solid #e2e8f0",padding:"16px"},productSection:{display:"flex",gap:"14px",alignItems:"center"},imageWrapper:{width:"64px",height:"64px",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f1f5f9",border:"1px solid #e2e8f0",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center"},productImage:{width:"100%",height:"100%",objectFit:"contain"},productInfo:{flex:1,display:"flex",flexDirection:"column",gap:"6px",minWidth:0},productTitle:{fontSize:"14px",fontWeight:600,color:"#1e293b",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},priceRow:{display:"flex",alignItems:"center",gap:"8px"},finalPrice:{fontSize:"18px",fontWeight:800,color:"#0f172a"},discountBadge:{padding:"2px 6px",borderRadius:"4px",backgroundColor:"#fef2f2",color:"#dc2626",fontSize:"11px",fontWeight:700},sectionHeader:{fontSize:"15px",fontWeight:700,color:"#334155",marginBottom:"12px",display:"flex",alignItems:"center",gap:"6px"},rankingList:{display:"flex",flexDirection:"column",gap:"10px"},rankItemBest:{backgroundColor:"#4f46e5",borderRadius:"16px",padding:"18px",position:"relative",overflow:"hidden"},rankBadgeBest:{display:"inline-flex",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.2)",color:"#ffffff",fontSize:"11px",fontWeight:700,padding:"4px 10px",borderRadius:"999px",marginBottom:"12px"},rankContent:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},rankLeft:{display:"flex",alignItems:"center",gap:"12px",flex:1,minWidth:0},rankIconBest:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"rgba(255, 255, 255, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",flexShrink:0},rankTitleBest:{fontSize:"15px",fontWeight:700,color:"#ffffff",marginBottom:"2px"},rankDescBest:{fontSize:"12px",color:"rgba(255, 255, 255, 0.8)",fontWeight:500},rankAmountBest:{fontSize:"20px",fontWeight:800,color:"#ffffff",flexShrink:0},rankItem:{backgroundColor:"#ffffff",borderRadius:"14px",border:"1px solid #e2e8f0",padding:"16px"},rankIcon:{width:"36px",height:"36px",borderRadius:"8px",backgroundColor:"#f1f5f9",display:"flex",alignItems:"center",justifyContent:"center",color:"#64748b",flexShrink:0},rankTitle:{fontSize:"14px",fontWeight:600,color:"#1e293b",marginBottom:"2px"},rankDesc:{fontSize:"12px",color:"#64748b"},rankAmount:{fontSize:"16px",fontWeight:700,color:"#dc2626",flexShrink:0},emptyState:{padding:"32px",textAlign:"center",color:"#94a3b8",fontSize:"14px"},footer:{padding:"16px 20px",backgroundColor:"#ffffff",borderTop:"1px solid #e2e8f0",marginTop:"auto"},ctaButton:{width:"100%",height:"48px",backgroundColor:"#1e293b",color:"#ffffff",fontSize:"15px",fontWeight:700,border:"none",borderRadius:"12px",cursor:"pointer",transition:"background-color 0.2s",display:"flex",alignItems:"center",justifyContent:"center"}},q=()=>{const s=h.useRef(null),{product:t,topBenefits:l,loading:m}=_();Y({enabled:!m,contentRef:s});const n=h.useMemo(()=>{if(!t)return[];const r=[],o=t.discountPrice||t.price||t.amount||0;if(t.cashback){const d=t.cashback?.amount||0;d>0&&r.push({id:"cashback",type:"cashback",title:"ì¿ íŒ¡ìºì‹œ ì ë¦½",description:"í˜œíƒ ê¸ˆì•¡ì´ ê°€ì¥ í½ë‹ˆë‹¤. (ì ë¦½)",amount:d,icon:"coins"})}if(l&&l.length>0&&l.forEach((d,f)=>{const u=d.rate??d.discount??0,x=u>0?Math.round(o*(u/100)):0;x>0&&r.push({id:`card-${f}`,type:"card",title:d.cardName||d.card||"ì œíœ´ ì¹´ë“œ",description:d.benefit||`${u}% ì¦‰ì‹œ í• ì¸ (ìµœëŒ€ 3ë§Œ)`,amount:x,icon:"card"})}),t.giftCardDiscount){const d=t.giftCardDiscount?.rate||0,f=d>0?Math.round(o*(d/100)):0;f>0&&r.push({id:"giftcard",type:"giftcard",title:"ê¸°í”„íŠ¸ì¹´ë“œ í• ì¸",description:t.giftCardDiscount?.description||`${d}% í• ì¸`,amount:f,icon:"gift"})}return r.sort((d,f)=>f.amount-d.amount)},[t,l]);if(m||!t)return null;const c=t.originalPrice||0,p=t.discountPrice||t.price||t.amount||0,a=t.discountRate||(c>0&&p>0?Math.round((c-p)/c*100):0),g=r=>{switch(r){case"card":return e.jsx(k,{size:18});case"coins":return e.jsx(R,{size:18});case"gift":return e.jsx(L,{size:18});default:return e.jsx(k,{size:18})}};return e.jsxs("div",{ref:s,style:i.wrapper,children:[e.jsxs("div",{style:i.header,children:[e.jsx("div",{style:i.logoWrapper,children:e.jsx("span",{style:i.title,children:"PicSel ê²°ì œ ì¶”ì²œ"})}),e.jsx("button",{style:i.closeBtn,onClick:()=>window.close(),children:e.jsx(A,{size:20})})]}),e.jsxs("div",{style:i.content,children:[e.jsx("div",{style:i.card,children:e.jsxs("div",{style:i.productSection,children:[e.jsx("div",{style:i.imageWrapper,children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:"Product",style:i.productImage}):e.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af",fontSize:"11px"},children:"Product"})}),e.jsxs("div",{style:i.productInfo,children:[e.jsx("div",{style:i.productTitle,children:t.title||"ìƒí’ˆëª… ì—†ìŒ"}),e.jsxs("div",{style:i.priceRow,children:[e.jsxs("span",{style:i.finalPrice,children:["â‚©",p.toLocaleString()]}),a>0&&e.jsxs("span",{style:i.discountBadge,children:["-",a,"%"]})]})]})]})}),e.jsxs("div",{children:[e.jsx("div",{style:i.sectionHeader,children:e.jsxs("span",{children:["ê²°ì œ í˜œíƒ ë­í‚¹ TOP ",n.length]})}),e.jsx("div",{style:i.rankingList,children:n.length>0?n.map((r,o)=>e.jsxs("div",{style:o===0?i.rankItemBest:i.rankItem,children:[o===0&&e.jsxs("div",{style:i.rankBadgeBest,children:[e.jsx(B,{size:12,style:{marginRight:"4px"}}),"#1 BEST"]}),e.jsxs("div",{style:i.rankContent,children:[e.jsxs("div",{style:i.rankLeft,children:[e.jsx("div",{style:o===0?i.rankIconBest:i.rankIcon,children:g(r.icon)}),e.jsxs("div",{children:[e.jsx("div",{style:o===0?i.rankTitleBest:i.rankTitle,children:r.title}),e.jsx("div",{style:o===0?i.rankDescBest:i.rankDesc,children:r.description})]})]}),e.jsxs("div",{style:o===0?i.rankAmountBest:i.rankAmount,children:["â‚©",r.amount.toLocaleString()]})]})]},r.id)):e.jsx("div",{style:i.emptyState,children:"í˜œíƒ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})})]})]}),e.jsx("div",{style:i.footer,children:e.jsx("button",{style:i.ctaButton,onClick:()=>window.close(),children:"í™•ì¸"})})]})},G=new URLSearchParams(window.location.search),N=G.get("auto")==="true";console.log(`ğŸª [SubPopup] Mode: ${N?"Auto":"Manual"}`);const w=document.getElementById("root");w&&I.createRoot(w).render(e.jsx(C.StrictMode,{children:N?e.jsx(q,{}):e.jsx(U,{})}));
