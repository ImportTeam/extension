import{s as k,E as X}from"./index-CtnQ7lw9.js";const Q=r=>{let u;const i=new Set,f=(g,b)=>{const A=typeof g=="function"?g(u):g;if(!Object.is(A,u)){const T=u;u=b??(typeof A!="object"||A===null)?A:Object.assign({},u,A),i.forEach(C=>C(u,T))}},E=()=>u,v={setState:f,getState:E,getInitialState:()=>R,subscribe:g=>(i.add(g),()=>i.delete(g))},R=u=r(f,E,v);return v},ct=(r=>r?Q(r):Q);function at(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var q={exports:{}},n={};var Z;function ft(){if(Z)return n;Z=1;var r=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),p=Symbol.for("react.consumer"),w=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),T=Symbol.iterator;function C(t){return t===null||typeof t!="object"?null:(t=T&&t[T]||t["@@iterator"],typeof t=="function"?t:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},l=Object.assign,O={};function S(t,e,s){this.props=t,this.context=e,this.refs=O,this.updater=s||j}S.prototype.isReactComponent={},S.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},S.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function h(){}h.prototype=S.prototype;function d(t,e,s){this.props=t,this.context=e,this.refs=O,this.updater=s||j}var P=d.prototype=new h;P.constructor=d,l(P,S.prototype),P.isPureReactComponent=!0;var N=Array.isArray;function Y(){}var m={H:null,A:null,T:null,S:null},W=Object.prototype.hasOwnProperty;function x(t,e,s){var o=s.ref;return{$$typeof:r,type:t,key:e,ref:o!==void 0?o:null,props:s}}function rt(t,e){return x(t.type,e,t.props)}function U(t){return typeof t=="object"&&t!==null&&t.$$typeof===r}function nt(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return e[s]})}var z=/\/+/g;function D(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nt(""+t.key):e.toString(36)}function ot(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(Y,Y):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function H(t,e,s,o,c){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var y=!1;if(t===null)y=!0;else switch(a){case"bigint":case"string":case"number":y=!0;break;case"object":switch(t.$$typeof){case r:case u:y=!0;break;case b:return y=t._init,H(y(t._payload),e,s,o,c)}}if(y)return c=c(t),y=o===""?"."+D(t,0):o,N(c)?(s="",y!=null&&(s=y.replace(z,"$&/")+"/"),H(c,e,s,"",function(it){return it})):c!=null&&(U(c)&&(c=rt(c,s+(c.key==null||t&&t.key===c.key?"":(""+c.key).replace(z,"$&/")+"/")+y)),e.push(c)),1;y=0;var I=o===""?".":o+":";if(N(t))for(var _=0;_<t.length;_++)o=t[_],a=I+D(o,_),y+=H(o,e,s,a,c);else if(_=C(t),typeof _=="function")for(t=_.call(t),_=0;!(o=t.next()).done;)o=o.value,a=I+D(o,_++),y+=H(o,e,s,a,c);else if(a==="object"){if(typeof t.then=="function")return H(ot(t),e,s,o,c);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return y}function $(t,e,s){if(t==null)return t;var o=[],c=0;return H(t,o,"","",function(a){return e.call(s,a,c++)}),o}function st(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var F=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ut={map:$,forEach:function(t,e,s){$(t,function(){e.apply(this,arguments)},s)},count:function(t){var e=0;return $(t,function(){e++}),e},toArray:function(t){return $(t,function(e){return e})||[]},only:function(t){if(!U(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};return n.Activity=A,n.Children=ut,n.Component=S,n.Fragment=i,n.Profiler=E,n.PureComponent=d,n.StrictMode=f,n.Suspense=R,n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=m,n.__COMPILER_RUNTIME={__proto__:null,c:function(t){return m.H.useMemoCache(t)}},n.cache=function(t){return function(){return t.apply(null,arguments)}},n.cacheSignal=function(){return null},n.cloneElement=function(t,e,s){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var o=l({},t.props),c=t.key;if(e!=null)for(a in e.key!==void 0&&(c=""+e.key),e)!W.call(e,a)||a==="key"||a==="__self"||a==="__source"||a==="ref"&&e.ref===void 0||(o[a]=e[a]);var a=arguments.length-2;if(a===1)o.children=s;else if(1<a){for(var y=Array(a),I=0;I<a;I++)y[I]=arguments[I+2];o.children=y}return x(t.type,c,o)},n.createContext=function(t){return t={$$typeof:w,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:p,_context:t},t},n.createElement=function(t,e,s){var o,c={},a=null;if(e!=null)for(o in e.key!==void 0&&(a=""+e.key),e)W.call(e,o)&&o!=="key"&&o!=="__self"&&o!=="__source"&&(c[o]=e[o]);var y=arguments.length-2;if(y===1)c.children=s;else if(1<y){for(var I=Array(y),_=0;_<y;_++)I[_]=arguments[_+2];c.children=I}if(t&&t.defaultProps)for(o in y=t.defaultProps,y)c[o]===void 0&&(c[o]=y[o]);return x(t,a,c)},n.createRef=function(){return{current:null}},n.forwardRef=function(t){return{$$typeof:v,render:t}},n.isValidElement=U,n.lazy=function(t){return{$$typeof:b,_payload:{_status:-1,_result:t},_init:st}},n.memo=function(t,e){return{$$typeof:g,type:t,compare:e===void 0?null:e}},n.startTransition=function(t){var e=m.T,s={};m.T=s;try{var o=t(),c=m.S;c!==null&&c(s,o),typeof o=="object"&&o!==null&&typeof o.then=="function"&&o.then(Y,F)}catch(a){F(a)}finally{e!==null&&s.types!==null&&(e.types=s.types),m.T=e}},n.unstable_useCacheRefresh=function(){return m.H.useCacheRefresh()},n.use=function(t){return m.H.use(t)},n.useActionState=function(t,e,s){return m.H.useActionState(t,e,s)},n.useCallback=function(t,e){return m.H.useCallback(t,e)},n.useContext=function(t){return m.H.useContext(t)},n.useDebugValue=function(){},n.useDeferredValue=function(t,e){return m.H.useDeferredValue(t,e)},n.useEffect=function(t,e){return m.H.useEffect(t,e)},n.useEffectEvent=function(t){return m.H.useEffectEvent(t)},n.useId=function(){return m.H.useId()},n.useImperativeHandle=function(t,e,s){return m.H.useImperativeHandle(t,e,s)},n.useInsertionEffect=function(t,e){return m.H.useInsertionEffect(t,e)},n.useLayoutEffect=function(t,e){return m.H.useLayoutEffect(t,e)},n.useMemo=function(t,e){return m.H.useMemo(t,e)},n.useOptimistic=function(t,e){return m.H.useOptimistic(t,e)},n.useReducer=function(t,e,s){return m.H.useReducer(t,e,s)},n.useRef=function(t){return m.H.useRef(t)},n.useState=function(t){return m.H.useState(t)},n.useSyncExternalStore=function(t,e,s){return m.H.useSyncExternalStore(t,e,s)},n.useTransition=function(){return m.H.useTransition()},n.version="19.2.3",n}var V;function lt(){return V||(V=1,q.exports=ft()),q.exports}var pt=lt();const M=at(pt),mt=r=>r;function yt(r,u=mt){const i=M.useSyncExternalStore(r.subscribe,M.useCallback(()=>u(r.getState()),[r,u]),M.useCallback(()=>u(r.getInitialState()),[r,u]));return M.useDebugValue(i),i}const Et=r=>{const u=ct(r),i=f=>yt(u,f);return Object.assign(i,u),i},Ct=(r=>Et);function gt(r,u){let i;try{i=r()}catch{return}return{getItem:E=>{var p;const w=R=>R===null?null:JSON.parse(R,void 0),v=(p=i.getItem(E))!=null?p:null;return v instanceof Promise?v.then(w):w(v)},setItem:(E,p)=>i.setItem(E,JSON.stringify(p,void 0)),removeItem:E=>i.removeItem(E)}}const J=r=>u=>{try{const i=r(u);return i instanceof Promise?i:{then(f){return J(f)(i)},catch(f){return this}}}catch(i){return{then(f){return this},catch(f){return J(f)(i)}}}},ht=(r,u)=>(i,f,E)=>{let p={storage:gt(()=>localStorage),partialize:l=>l,version:0,merge:(l,O)=>({...O,...l}),...u},w=!1;const v=new Set,R=new Set;let g=p.storage;if(!g)return r((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${p.name}', the given storage is currently unavailable.`),i(...l)},f,E);const b=()=>{const l=p.partialize({...f()});return g.setItem(p.name,{state:l,version:p.version})},A=E.setState;E.setState=(l,O)=>(A(l,O),b());const T=r((...l)=>(i(...l),b()),f,E);E.getInitialState=()=>T;let C;const j=()=>{var l,O;if(!g)return;w=!1,v.forEach(h=>{var d;return h((d=f())!=null?d:T)});const S=((O=p.onRehydrateStorage)==null?void 0:O.call(p,(l=f())!=null?l:T))||void 0;return J(g.getItem.bind(g))(p.name).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==p.version){if(p.migrate){const d=p.migrate(h.state,h.version);return d instanceof Promise?d.then(P=>[!0,P]):[!0,d]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,h.state];return[!1,void 0]}).then(h=>{var d;const[P,N]=h;if(C=p.merge(N,(d=f())!=null?d:T),i(C,!0),P)return b()}).then(()=>{S?.(C,void 0),C=f(),w=!0,R.forEach(h=>h(C))}).catch(h=>{S?.(void 0,h)})};return E.persist={setOptions:l=>{p={...p,...l},l.storage&&(g=l.storage)},clearStorage:()=>{g?.removeItem(p.name)},getOptions:()=>p,rehydrate:()=>j(),hasHydrated:()=>w,onHydrate:l=>(v.add(l),()=>{v.delete(l)}),onFinishHydration:l=>(R.add(l),()=>{R.delete(l)})},p.skipHydration||j(),C||T},It=ht,G=new Map;let tt=!1;function B(){return typeof chrome<"u"&&!!chrome.storage?.local&&typeof chrome.runtime<"u"}function et(){try{return globalThis.location?.protocol??""}catch{return""}}function _t(){try{const r=globalThis.location?.hostname??"";return r==="localhost"||r==="127.0.0.1"||r==="0.0.0.0"}catch{return!1}}function L(){const r=et();return r==="chrome-extension:"||(r==="http:"||r==="https:")&&_t()}function dt(r){try{return globalThis.localStorage?.getItem(r)??null}catch{return null}}function vt(r,u){try{return globalThis.localStorage?.setItem(r,u),!0}catch{return!1}}function St(r){try{return globalThis.localStorage?.removeItem(r),!0}catch{return!1}}function K(r){if(tt)return;tt=!0;const u={key:r,protocol:et()||"unknown",href:(()=>{try{return globalThis.location?.href}catch{return}})()};L()?k.warn("chrome.storage.local not available, using fallback storage",u):k.debug("chrome.storage.local not available, using in-memory storage (no persistence)",u)}const Rt={getItem:async r=>new Promise(u=>{if(!B()){if(K(r),L()){u(dt(r));return}u(G.get(r)??null);return}chrome.storage.local.get([r],i=>{if(chrome.runtime.lastError){k.warn("chromeStorage getItem failed",{key:r,error:chrome.runtime.lastError.message}),u(null);return}u(i[r]??null)})}),setItem:async(r,u)=>new Promise((i,f)=>{if(!B()){if(K(r),L()){vt(r,u)?i():f(new Error("localStorage setItem failed"));return}G.set(r,u),i();return}chrome.storage.local.set({[r]:u},()=>{if(chrome.runtime.lastError){const E=new Error(`chromeStorage setItem failed: ${chrome.runtime.lastError.message}`);k.error(X.STO_E001,"chromeStorage setItem failed",{data:{key:r},error:E}),f(new Error(chrome.runtime.lastError.message??"Failed to save to storage"));return}i()})}),removeItem:async r=>new Promise((u,i)=>{if(!B()){if(K(r),L()){St(r)?u():i(new Error("localStorage removeItem failed"));return}G.delete(r),u();return}chrome.storage.local.remove([r],()=>{if(chrome.runtime.lastError){const f=new Error(`chromeStorage removeItem failed: ${chrome.runtime.lastError.message}`);k.error(X.STO_E001,"chromeStorage removeItem failed",{data:{key:r},error:f}),i(new Error(chrome.runtime.lastError.message??"Failed to remove from storage"));return}u()})})};function wt(){return Rt}const bt={RECOMMENDATION:"picsel-recommendation",SUBPOPUP:"subpopup-store",SETTINGS:"picsel-settings"},At=1800*1e3;export{At as M,M as R,bt as S,wt as a,lt as b,Ct as c,at as g,It as p,pt as r};
