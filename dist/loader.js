(()=>{try{console.warn("[PicSel] loader starting",{runtimeId:chrome?.runtime?.id,hasRuntime:!!chrome?.runtime,hasSendMessage:typeof chrome?.runtime?.sendMessage=="function",href:globalThis.location?.href});const r=chrome.runtime.getURL("content.js");try{const e=Array.from(document.querySelectorAll("script[src]")).map(t=>t).filter(t=>{const c=t.getAttribute("src")||"";return c.includes("/content.js")&&c.includes("chrome-extension://")});e.length>0&&(e.forEach(t=>t.remove()),console.warn("[PicSel] removed legacy injected content.js scripts",{count:e.length}))}catch(e){console.error("[PicSel] legacy script cleanup failed",e)}import(r).then(()=>{console.warn("[PicSel] content.js loaded via dynamic import (isolated world)")}).catch(e=>{console.error("[PicSel] Failed to import content.js",e)})}catch(r){console.error("[PicSel] Loader crashed before importing content.js",r)}})();
